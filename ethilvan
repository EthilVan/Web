#! /usr/bin/env ruby
# encoding: utf-8
require 'thor'

module EthilVan
   class CLI < Thor

      include Thor::Actions

      no_tasks do
         def load_environment
            require './config/env'
         end
      end

      desc 'console',
            'Débute un shell ruby interactif avec l\'environnement chargé'
      def console
         load_environment
         Pry.config.prompt = [
            proc { |obj, nest_level, _| "#{obj} (#{nest_level}) >> " },
            proc { |obj, nest_level, _| "#{obj} (#{nest_level}) << " }
         ]
         EthilVan.pry
      end

      desc 'emoji', 'Installe les emoji dans le dossier "public/images/emoji"'
      def emoji
         load_environment
         rrequire 'lib/tasks/emoji_install'
         EthilVan::Emoji.install
      end

      desc 'assets', 'Process assets'
      def assets
         load_environment
         rrequire_dir 'lib/assets'
         EthilVan::Assets::Style.new("app").compile
         EthilVan::Assets::Scripts.new("app").compile
      end
   end
end

EthilVan::CLI.start
